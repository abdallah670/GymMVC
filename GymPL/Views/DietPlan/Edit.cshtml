@model GymBLL.ModelVM.Nutrition.DietPlanVM

@{
    ViewData["Title"] = "Edit Diet Plan";
    var returnPage = Context.Request.Query["page"].FirstOrDefault() ?? "1";
    var returnUrl = Context.Request.Query["returnUrl"].FirstOrDefault();
    // Determine the back URL
    string backUrl;


    if (!string.IsNullOrEmpty(returnUrl))
    {
        // Use the provided returnUrl
        backUrl = returnUrl;
    }
    else
    {
        // Default: Go back to Index with page number
        backUrl = Url.Action("Index", new { page = returnPage });
    }
}

<div class="container" style="max-width: 700px; margin: 2rem auto; padding: 0 1rem;">
    <div style="margin-bottom: 1.5rem;">
        <a href="@backUrl"  class="btn btn-secondary">
            <i class="fas fa-arrow-left" ></i> Back
        </a>
    </div>

    <div style="background: var(--tile); padding: 2rem; border-radius: var(--radius); border: 1px solid var(--frame);">
        <h2 style="color: var(--ink); margin-bottom: 1.5rem;">
            <i class="fas fa-edit"></i> Edit Diet Plan
        </h2>


        <form asp-action="Edit" method="post">
            @Html.AntiForgeryToken()
            <input type="hidden" asp-for="Id" />
            <input type="hidden" name="returnPage" value="@returnPage" />
            <input type="hidden" name="returnUrl" value="@returnUrl" />

            <div class="form-group" style="margin-bottom: 1rem;">
                <label asp-for="Name" style="color: var(--ink); font-weight: 500; display: block; margin-bottom: 0.5rem;">Plan Name *</label>
                <input asp-for="Name" class="form-control" placeholder="e.g., High Protein Diet"
                       style="width: 100%; padding: 0.75rem; border: 1px solid var(--frame); border-radius: var(--radius); background: var(--tile); color: var(--ink);" required />
                <span asp-validation-for="Name" class="text-danger"></span>
            </div>

            <div class="form-group" style="margin-bottom: 1rem;">
                <label asp-for="Description" style="color: var(--ink); font-weight: 500; display: block; margin-bottom: 0.5rem;">Description</label>
                <textarea asp-for="Description" class="form-control" rows="3" placeholder="Describe the diet plan..."
                          style="width: 100%; padding: 0.75rem; border: 1px solid var(--frame); border-radius: var(--radius); background: var(--tile); color: var(--ink);"></textarea>
                <span asp-validation-for="Description" class="text-danger"></span>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                <div class="form-group">
                    <label asp-for="TotalCalories" style="color: var(--ink); font-weight: 500; display: block; margin-bottom: 0.5rem;">Daily Calories *</label>
                    <input asp-for="TotalCalories" type="number" class="form-control" min="500" max="10000"
                           style="width: 100%; padding: 0.75rem; border: 1px solid var(--frame); border-radius: var(--radius); background: var(--tile); color: var(--ink);" required />
                    <span asp-validation-for="TotalCalories" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="DietType" style="color: var(--ink); font-weight: 500; display: block; margin-bottom: 0.5rem;">Diet Type *</label>
                    <select asp-for="DietType" class="form-control"
                            style="width: 100%; padding: 0.75rem; border: 1px solid var(--frame); border-radius: var(--radius); background: var(--tile); color: var(--ink);" required>
                        <option value="">Select Type</option>
                        <option value="Balanced">Balanced</option>
                        <option value="High Protein">High Protein</option>
                        <option value="Low Carb">Low Carb</option>
                        <option value="Keto">Keto</option>
                        <option value="Vegan">Vegan</option>
                        <option value="Vegetarian">Vegetarian</option>
                        <option value="Mediterranean">Mediterranean</option>
                    </select>
                    <span asp-validation-for="DietType" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 1rem;">
                <label asp-for="DurationDays" style="color: var(--ink); font-weight: 500; display: block; margin-bottom: 0.5rem;">Duration (Days) *</label>
                <input asp-for="DurationDays" type="number" class="form-control" min="1" max="365"
                       style="width: 100%; padding: 0.75rem; border: 1px solid var(--frame); border-radius: var(--radius); background: var(--tile); color: var(--ink);" required />
                <span asp-validation-for="DurationDays" class="text-danger"></span>
            </div>

            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label style="color: var(--ink); font-weight: 500; display: block; margin-bottom: 0.5rem;">Status</label>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <input type="checkbox" asp-for="IsActive" id="IsActive" style="width: 18px; height: 18px;" />
                    <label for="IsActive" style="color: var(--ink); margin: 0;">Active</label>
                </div>
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%; padding: 0.75rem; font-size: 1rem;">
                <i class="fas fa-save"></i> Update Diet Plan
            </button>
        </form>
    </div>
</div>
